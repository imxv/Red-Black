# å¦‚ä½•æŸ¥çœ‹æ³¨å†Œçš„ç”¨æˆ·

## ğŸ¯ å¿«é€Ÿå›ç­”

ä½ çš„ç”¨æˆ·æ•°æ®**ç¡®å®åœ¨æ•°æ®åº“ä¸­**ï¼Œåªæ˜¯ä¸åœ¨ Supabase çš„ Authentication é¡µé¢ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Better Authï¼Œè€Œä¸æ˜¯ Supabase Authã€‚

## ğŸ“ ä½ çš„ç”¨æˆ·åœ¨å“ªé‡Œï¼Ÿ

### âœ… æ­£ç¡®ä½ç½®ï¼šTable Editor

1. è®¿é—® Supabase Dashboardï¼š
   ğŸ‘‰ https://supabase.com/dashboard/project/wifxwnyzzckrlqbzyvxj

2. ç‚¹å‡»å·¦ä¾§èœå•çš„ **Table Editor**

3. åœ¨è¡¨åˆ—è¡¨ä¸­é€‰æ‹© **User** è¡¨

4. ä½ ä¼šçœ‹åˆ°æ‰€æœ‰æ³¨å†Œçš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬ï¼š
   - id
   - email
   - name
   - isMerchant
   - createdAt
   - ç­‰ç­‰...

### âŒ é”™è¯¯ä½ç½®ï¼šAuthentication

**Authentication é¡µé¢æ˜¯ç©ºçš„**æ˜¯æ­£å¸¸çš„ï¼

å› ä¸ºï¼š
- Authentication æ˜¯ Supabase çš„å†…ç½®è®¤è¯æœåŠ¡
- æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Better Authï¼ˆç‹¬ç«‹çš„è®¤è¯ç³»ç»Ÿï¼‰
- Better Auth æŠŠç”¨æˆ·å­˜åœ¨ `public.User` è¡¨
- Supabase Auth æŠŠç”¨æˆ·å­˜åœ¨ `auth.users` è¡¨ï¼ˆæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ï¼‰

## ğŸ” æŸ¥çœ‹ç”¨æˆ·çš„ 3 ç§æ–¹æ³•

### æ–¹æ³• 1ï¼šSupabase Table Editorï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹**ï¼šåœ¨çº¿æŸ¥çœ‹ï¼Œæ–¹ä¾¿å¿«æ·

**æ­¥éª¤**ï¼š
1. Supabase Dashboard â†’ Table Editor
2. é€‰æ‹© `User` è¡¨
3. æŸ¥çœ‹æ‰€æœ‰å­—æ®µå’Œæ•°æ®

**å¯ä»¥åšä»€ä¹ˆ**ï¼š
- âœ… æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
- âœ… æœç´¢ç”¨æˆ·
- âœ… ç¼–è¾‘ç”¨æˆ·æ•°æ®
- âœ… åˆ é™¤ç”¨æˆ·
- âœ… æŸ¥çœ‹å…³è”æ•°æ®ï¼ˆSessionã€Merchant ç­‰ï¼‰

### æ–¹æ³• 2ï¼šPrisma Studioï¼ˆåŠŸèƒ½æœ€å¼ºï¼‰

**ä¼˜ç‚¹**ï¼šæœ¬åœ°è¿è¡Œï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œå¯è§†åŒ–å…³ç³»

**å¯åŠ¨å‘½ä»¤**ï¼š
```bash
npm run db:studio
```

**è‡ªåŠ¨æ‰“å¼€** http://localhost:5555

**å¯ä»¥åšä»€ä¹ˆ**ï¼š
- âœ… æŸ¥çœ‹æ‰€æœ‰è¡¨
- âœ… å¯è§†åŒ–è¡¨å…³ç³»
- âœ… å¿«é€Ÿç¼–è¾‘æ•°æ®
- âœ… æ‰§è¡Œå¤æ‚æŸ¥è¯¢
- âœ… å¯¼å‡ºæ•°æ®

### æ–¹æ³• 3ï¼šSQL Editor

**ä¼˜ç‚¹**ï¼šçµæ´»å¼ºå¤§ï¼Œå¯ä»¥å†™å¤æ‚æŸ¥è¯¢

**æ­¥éª¤**ï¼š
1. Supabase Dashboard â†’ SQL Editor
2. æ–°å»ºæŸ¥è¯¢
3. è¿è¡Œ SQLï¼š

```sql
-- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
SELECT * FROM "User";

-- æŸ¥çœ‹ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬ä¼šè¯ï¼‰
SELECT 
  u.id,
  u.email,
  u.name,
  u."isMerchant",
  u."createdAt",
  COUNT(s.id) as session_count
FROM "User" u
LEFT JOIN "Session" s ON s."userId" = u.id
GROUP BY u.id;

-- æŸ¥çœ‹æœ€è¿‘æ³¨å†Œçš„ç”¨æˆ·
SELECT * FROM "User" 
ORDER BY "createdAt" DESC 
LIMIT 10;

-- æŸ¥çœ‹å•†å®¶ç”¨æˆ·
SELECT * FROM "User" 
WHERE "isMerchant" = true;
```

## ğŸ“Š æ•°æ®è¡¨å¯¹ç…§

### æˆ‘ä»¬çš„è¡¨ï¼ˆBetter Authï¼‰
```
public.User          â† ä½ çš„ç”¨æˆ·åœ¨è¿™é‡Œï¼
public.Session       â† ç™»å½•ä¼šè¯
public.Account       â† è´¦å·ä¿¡æ¯ï¼ˆå¯†ç ï¼‰
public.Verification  â† éªŒè¯è®°å½•
```

### Supabase Auth çš„è¡¨ï¼ˆæˆ‘ä»¬æ²¡ç”¨ï¼‰
```
auth.users           â† ç©ºçš„
auth.sessions        â† ç©ºçš„
auth.identities      â† ç©ºçš„
```

## ğŸ¨ Prisma Studio æˆªå›¾æŒ‡å—

å¯åŠ¨ `npm run db:studio` åï¼Œä½ ä¼šçœ‹åˆ°ï¼š

**å·¦ä¾§é¢æ¿**ï¼š
- Userï¼ˆç‚¹å‡»æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·ï¼‰
- Session
- Account
- Merchant
- Post
- Comment
- Reaction
- ç­‰ç­‰...

**ä¸­é—´é¢æ¿**ï¼š
- ç”¨æˆ·åˆ—è¡¨ï¼ˆå¯ä»¥æ»šåŠ¨ã€æœç´¢ã€æ’åºï¼‰
- æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªç”¨æˆ·

**å³ä¾§é¢æ¿**ï¼š
- ç‚¹å‡»ç”¨æˆ·æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
- å¯ä»¥ç¼–è¾‘å­—æ®µ
- å¯ä»¥æŸ¥çœ‹å…³è”æ•°æ®

## ğŸ’¡ ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ

### Better Auth çš„ä¼˜åŠ¿

1. **å®Œå…¨æ§åˆ¶**
   - ç”¨æˆ·è¡¨åœ¨ä½ çš„ schema ä¸­
   - å¯ä»¥è‡ªç”±æ‰©å±•å­—æ®µ
   - å¯ä»¥è‡ªå®šä¹‰å…³ç³»

2. **ä¸šåŠ¡çµæ´»æ€§**
   - æ·»åŠ  `isMerchant` å­—æ®µ
   - ä¸ Merchant è¡¨å…³è”
   - ä¸ Postã€Comment ç­‰å…³è”

3. **æ•°æ®å¯è§æ€§**
   - æ‰€æœ‰æ•°æ®éƒ½åœ¨ `public` schema
   - å¯ä»¥ç”¨ä»»ä½•å·¥å…·æŸ¥çœ‹
   - ä¸ä¾èµ–ç‰¹å®šæœåŠ¡

### å¦‚æœç”¨ Supabase Auth

âŒ ç”¨æˆ·è¡¨ç»“æ„å›ºå®šï¼Œéš¾ä»¥æ‰©å±•  
âŒ éœ€è¦é¢å¤–çš„è¡¨æ¥å­˜å‚¨ä¸šåŠ¡å­—æ®µ  
âŒ æ•°æ®åœ¨ `auth` schemaï¼Œä¸æ˜“è®¿é—®  
âŒ ä¾èµ– Supabaseï¼Œéš¾ä»¥è¿ç§»  

## âœ… æ€»ç»“

**ä½ çš„ç”¨æˆ·æ•°æ®å®Œå…¨æ­£å¸¸ï¼**

- âœ… ç”¨æˆ·åœ¨ `public.User` è¡¨ä¸­
- âœ… å¯ä»¥é€šè¿‡ Table Editor æŸ¥çœ‹
- âœ… å¯ä»¥é€šè¿‡ Prisma Studio ç®¡ç†
- âœ… Authentication é¡µé¢ç©ºçš„æ˜¯æ­£å¸¸çš„

**æ¨èä½¿ç”¨ Prisma Studio**ï¼ŒåŠŸèƒ½æœ€å¼ºå¤§ï¼š
```bash
npm run db:studio
```

---

**æœ‰ç–‘é—®ï¼Ÿ** æŸ¥çœ‹ [BETTER_AUTH_VS_SUPABASE_AUTH.md](./BETTER_AUTH_VS_SUPABASE_AUTH.md) äº†è§£ä¸¤ä¸ªç³»ç»Ÿçš„è¯¦ç»†å¯¹æ¯”ã€‚
