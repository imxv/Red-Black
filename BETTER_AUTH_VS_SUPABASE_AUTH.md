# Better Auth vs Supabase Auth å¯¹æ¯”

## ğŸ¤” ä½ çš„ç–‘é—®

> ä¸ºä»€ä¹ˆ Supabase çš„ Authentication é¡µé¢é‡Œçœ‹ä¸åˆ°æˆ‘æ³¨å†Œçš„ç”¨æˆ·ï¼Ÿ

**ç­”æ¡ˆ**ï¼šå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ **Better Auth**ï¼Œè€Œä¸æ˜¯ **Supabase Auth**ã€‚è¿™æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„è®¤è¯ç³»ç»Ÿã€‚

## ğŸ“Š ä¸¤è€…åŒºåˆ«

### Better Authï¼ˆæˆ‘ä»¬å½“å‰ä½¿ç”¨çš„ï¼‰

**å·¥ä½œæ–¹å¼**ï¼š
- ç‹¬ç«‹çš„ç¬¬ä¸‰æ–¹è®¤è¯åº“
- ç›´æ¥åœ¨ä½ çš„ `public` schema ä¸­åˆ›å»ºè¡¨
- ç”¨æˆ·æ•°æ®å­˜å‚¨åœ¨ `public.User` è¡¨
- å®Œå…¨ç”±ä½ æ§åˆ¶

**æ•°æ®è¡¨ä½ç½®**ï¼š
```
public.User
public.Session
public.Account
public.Verification
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨æ§åˆ¶ç”¨æˆ·æ•°æ®å’Œè¡¨ç»“æ„
- âœ… å¯ä»¥è‡ªç”±æ‰©å±• User æ¨¡å‹ï¼ˆå¦‚æˆ‘ä»¬çš„ `isMerchant` å­—æ®µï¼‰
- âœ… ä¸ Prisma å®Œç¾é›†æˆ
- âœ… ä¸ä¾èµ– Supabaseï¼Œå¯ä»¥è¿ç§»åˆ°å…¶ä»–æ•°æ®åº“
- âœ… çµæ´»çš„è®¤è¯ç­–ç•¥é…ç½®
- âœ… æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼ˆé‚®ç®±ã€ç¤¾äº¤ç™»å½•ç­‰ï¼‰

**ç¼ºç‚¹**ï¼š
- âš ï¸ ä¸ä¼šæ˜¾ç¤ºåœ¨ Supabase Dashboard çš„ Authentication é¡µé¢
- âš ï¸ éœ€è¦è‡ªå·±ç®¡ç†ä¼šè¯å’Œæƒé™
- âš ï¸ ä¸èƒ½ä½¿ç”¨ Supabase çš„ Row Level Securityï¼ˆRLSï¼‰è‡ªåŠ¨åŠŸèƒ½

### Supabase Authï¼ˆå†…ç½®æœåŠ¡ï¼‰

**å·¥ä½œæ–¹å¼**ï¼š
- Supabase æä¾›çš„æ‰˜ç®¡è®¤è¯æœåŠ¡
- ç”¨æˆ·æ•°æ®å­˜å‚¨åœ¨ `auth.users` schemaï¼ˆå—ä¿æŠ¤çš„ schemaï¼‰
- é€šè¿‡ Supabase Client SDK è®¿é—®

**æ•°æ®è¡¨ä½ç½®**ï¼š
```
auth.users (ä¸åœ¨ public schema)
auth.sessions
auth.identities
```

**ä¼˜ç‚¹**ï¼š
- âœ… åœ¨ Supabase Dashboard å¯è§†åŒ–ç®¡ç†
- âœ… å†…ç½® Row Level Security (RLS) é›†æˆ
- âœ… è‡ªåŠ¨å¤„ç†é‚®ç®±éªŒè¯ã€å¯†ç é‡ç½®
- âœ… å†…ç½®ç¤¾äº¤ç™»å½•ï¼ˆGoogle, GitHub ç­‰ï¼‰
- âœ… å¼€ç®±å³ç”¨çš„å®‰å…¨åŠŸèƒ½

**ç¼ºç‚¹**ï¼š
- âš ï¸ ç”¨æˆ·è¡¨ç»“æ„å›ºå®šï¼Œä¸æ˜“æ‰©å±•
- âš ï¸ ä¾èµ– Supabaseï¼Œè¿ç§»å›°éš¾
- âš ï¸ éœ€è¦ä½¿ç”¨ Supabase Client SDK
- âš ï¸ ä¸ Prisma é›†æˆè¾ƒå¤æ‚

## ğŸ¯ ä¸ºä»€ä¹ˆé€‰æ‹© Better Authï¼Ÿ

åŸºäºä½ çš„é¡¹ç›®éœ€æ±‚ï¼Œæˆ‘é€‰æ‹©äº† Better Authï¼ŒåŸå› ï¼š

### 1. çµæ´»çš„ç”¨æˆ·æ¨¡å‹
ä½ çš„éœ€æ±‚ä¸­ç”¨æˆ·å¯ä»¥"æˆä¸ºå•†å®¶"ï¼Œéœ€è¦ `isMerchant` å­—æ®µå’Œ `Merchant` å…³è”ã€‚ä½¿ç”¨ Better Auth å¯ä»¥è½»æ¾æ‰©å±•ï¼š

```prisma
model User {
  id         String   @id
  email      String   @unique
  name       String?
  isMerchant Boolean  @default(false)  // è‡ªå®šä¹‰å­—æ®µ
  merchant   Merchant?                  // è‡ªå®šä¹‰å…³è”
  // ... å…¶ä»–è‡ªå®šä¹‰å­—æ®µ
}
```

### 2. Prisma é›†æˆ
ä½ çš„é¡¹ç›®ä½¿ç”¨ Prismaï¼ŒBetter Auth ä¸ Prisma æ— ç¼é›†æˆï¼Œæ‰€æœ‰ç”¨æˆ·æ•°æ®éƒ½åœ¨ä½ çš„æ§åˆ¶ä¹‹ä¸‹ã€‚

### 3. å®Œæ•´çš„æ•°æ®åº“è®¾è®¡
æˆ‘ä»¬è®¾è®¡äº†å®Œæ•´çš„å…³ç³»æ¨¡å‹ï¼ˆMerchantã€Postã€Commentã€Reaction ç­‰ï¼‰ï¼Œè¿™äº›éƒ½ä¸ User è¡¨æœ‰å¤–é”®å…³è”ï¼Œä½¿ç”¨ Better Auth æ›´è‡ªç„¶ã€‚

### 4. å¯ç§»æ¤æ€§
å¦‚æœå°†æ¥æƒ³ä» Supabase è¿ç§»åˆ°å…¶ä»–æ•°æ®åº“ï¼ˆå¦‚ Railwayã€Vercel Postgres ç­‰ï¼‰ï¼Œä¸éœ€è¦æ”¹åŠ¨è®¤è¯é€»è¾‘ã€‚

## ğŸ”„ å¯ä»¥åˆ‡æ¢åˆ° Supabase Auth å—ï¼Ÿ

**å¯ä»¥**ï¼Œä½†éœ€è¦é‡æ„ã€‚è®©æˆ‘å¯¹æ¯”ä¸€ä¸‹åˆ‡æ¢çš„å½±å“ï¼š

### åˆ‡æ¢åˆ° Supabase Auth éœ€è¦ï¼š

#### ä¼˜ç‚¹ï¼š
- âœ… åœ¨ Supabase Dashboard çœ‹åˆ°ç”¨æˆ·
- âœ… ä½¿ç”¨ Supabase çš„ RLS ä¿æŠ¤æ•°æ®
- âœ… ç®€åŒ–æŸäº›æ“ä½œï¼ˆé‚®ç®±éªŒè¯ç­‰ï¼‰

#### ç¼ºç‚¹ï¼š
- âš ï¸ éœ€è¦é‡æ„æ‰€æœ‰è®¤è¯ä»£ç 
- âš ï¸ éœ€è¦è°ƒæ•´æ•°æ®åº“è®¾è®¡
- âš ï¸ User è¡¨éœ€è¦å¼•ç”¨ `auth.users`
- âš ï¸ ä¼šè¯ç®¡ç†æ–¹å¼æ”¹å˜
- âš ï¸ ç°æœ‰çš„ Better Auth é…ç½®å…¨éƒ¨ä½œåºŸ

#### å·¥ä½œé‡ï¼š
- ğŸ”¨ åˆ é™¤ Better Auth ç›¸å…³ä»£ç 
- ğŸ”¨ å®‰è£… `@supabase/supabase-js`
- ğŸ”¨ é‡æ„ `src/lib/auth.ts` å’Œ `src/lib/auth-client.ts`
- ğŸ”¨ ä¿®æ”¹æ‰€æœ‰è®¤è¯ç›¸å…³ç»„ä»¶
- ğŸ”¨ è°ƒæ•´æ•°æ®åº“ schema
- ğŸ”¨ è¿ç§»ç°æœ‰ç”¨æˆ·æ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰

**é¢„ä¼°æ—¶é—´ï¼š2-3 å°æ—¶**

## ğŸ’¡ æˆ‘çš„å»ºè®®

### æ–¹æ¡ˆ Aï¼šç»§ç»­ä½¿ç”¨ Better Authï¼ˆæ¨èï¼‰

**ç†ç”±**ï¼š
1. âœ… å·²ç»å®Œæˆå¹¶æµ‹è¯•é€šè¿‡
2. âœ… æ›´çµæ´»ï¼Œé€‚åˆä½ çš„ä¸šåŠ¡éœ€æ±‚
3. âœ… å®Œå…¨æ§åˆ¶ç”¨æˆ·æ•°æ®
4. âœ… ä¸ç°æœ‰è®¾è®¡å®Œç¾å¥‘åˆ

**ç¼ºç‚¹**ï¼š
- ä¸èƒ½åœ¨ Supabase Dashboard çœ‹åˆ°ç”¨æˆ·ï¼ˆä½†å¯ä»¥ç”¨ Prisma Studio æˆ– Table Editorï¼‰

### æ–¹æ¡ˆ Bï¼šåˆ‡æ¢åˆ° Supabase Auth

**é€‚åˆæƒ…å†µ**ï¼š
- ä½ éå¸¸éœ€è¦ Supabase Dashboard çš„å¯è§†åŒ–ç®¡ç†
- ä½ è®¡åˆ’ä½¿ç”¨ Supabase çš„å…¶ä»–æœåŠ¡ï¼ˆStorageã€Realtime ç­‰ï¼‰
- ä½ éœ€è¦ Row Level Security (RLS)

**éœ€è¦æŠ•å…¥æ—¶é—´é‡æ„**

## ğŸ“‹ å¦‚ä½•åœ¨ Supabase æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼Ÿ

è™½ç„¶ä¸åœ¨ Authentication é¡µé¢ï¼Œä½†ä½ å¯ä»¥è¿™æ ·æŸ¥çœ‹ï¼š

### æ–¹æ³• 1ï¼šTable Editorï¼ˆæ¨èï¼‰

1. è®¿é—® Supabase Dashboard
2. ç‚¹å‡» **Table Editor**
3. é€‰æ‹© **User** è¡¨
4. å¯ä»¥çœ‹åˆ°æ‰€æœ‰æ³¨å†Œçš„ç”¨æˆ·

### æ–¹æ³• 2ï¼šSQL Editor

åœ¨ SQL Editor ä¸­è¿è¡Œï¼š
```sql
SELECT * FROM "User";
```

### æ–¹æ³• 3ï¼šPrisma Studio

```bash
npm run db:studio
```

è¿™ä¼šæ‰“å¼€ä¸€ä¸ªæœ¬åœ°å¯è§†åŒ–ç•Œé¢ï¼ŒåŠŸèƒ½æ¯” Supabase Table Editor è¿˜å¼ºå¤§ã€‚

## ğŸ¯ ç»“è®º

**æˆ‘å»ºè®®ç»§ç»­ä½¿ç”¨ Better Auth**ï¼Œå› ä¸ºï¼š

1. âœ… å·²ç»å·¥ä½œæ­£å¸¸
2. âœ… æ›´é€‚åˆä½ çš„ä¸šåŠ¡éœ€æ±‚
3. âœ… å®Œå…¨æ»¡è¶³åŠŸèƒ½è¦æ±‚
4. âœ… æ•°æ®å®Œå…¨å¯è§ï¼ˆé€šè¿‡ Table Editor æˆ– Prisma Studioï¼‰

Supabase çš„ Authentication åŠŸèƒ½è™½ç„¶å¼ºå¤§ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ª"æ‰˜ç®¡æœåŠ¡"ï¼Œæ„å‘³ç€æ•°æ®ä¸åœ¨ä½ çš„æ§åˆ¶èŒƒå›´å†…ã€‚å¯¹äºä½ çš„é¡¹ç›®æ¥è¯´ï¼ŒBetter Auth æä¾›äº†æ›´å¥½çš„çµæ´»æ€§ã€‚

## ğŸ“š è¡¥å……è¯´æ˜

### Supabase Auth ä¸»è¦ç”¨äºï¼š
- ç®€å•çš„ç”¨æˆ·è®¤è¯éœ€æ±‚
- éœ€è¦å¿«é€ŸåŸå‹å¼€å‘
- é«˜åº¦ä¾èµ– Supabase ç”Ÿæ€

### Better Auth ä¸»è¦ç”¨äºï¼š
- éœ€è¦è‡ªå®šä¹‰ç”¨æˆ·æ¨¡å‹
- å¤æ‚çš„ä¸šåŠ¡é€»è¾‘
- å¸Œæœ›ä¿æŒæ•°æ®åº“ç‹¬ç«‹æ€§
- ä¸ Prisma/TypeORM ç­‰ ORM é›†æˆ

---

**æ€»ç»“**ï¼šä½ çš„ç”¨æˆ·æ•°æ®åœ¨ `public.User` è¡¨ä¸­ï¼Œå¯ä»¥é€šè¿‡ Table Editor æˆ– Prisma Studio æŸ¥çœ‹ã€‚Supabase Auth æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å®ƒï¼Œæ‰€ä»¥ Authentication é¡µé¢æ˜¯ç©ºçš„â€”â€”è¿™æ˜¯æ­£å¸¸çš„ï¼
